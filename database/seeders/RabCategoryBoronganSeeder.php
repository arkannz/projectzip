<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Type;
use App\Models\RabCategory;
use App\Models\RabCategoryBorongan;

class RabCategoryBoronganSeeder extends Seeder
{
    public function run()
    {
        // =====================================================
        // BORONGAN PER KATEGORI PER TYPE
        // Setiap type memiliki nilai borongan berbeda per kategori
        // =====================================================

        $boronganData = [
            // =============== TYPE 36 ===============
            '36' => [
                'A' => 2500000,  // PONDASI
                'B' => 1000000,  // URUG
                'C' => 600000,   // COR LANTAI
                'D' => 0,        // PINTU
                'E' => 4000000,  // BATA
                'F' => 0,        // COR TIANG DEPAN
                'G' => 3500000,  // PLASTER
                'H' => 2000000,  // ATAP
                'I' => 1200000,  // DEK
                'J' => 1000000,  // MINIMALIS
                'K' => 1000000,  // CARPORT
                'L' => 1800000,  // KERAMIK
                'M' => 750000,   // WC
                'N' => 1000000,  // ACI MINIMALIS
                'O' => 2000000,  // CAT
                'P' => 400000,   // PAGAR
                'Q' => 500000,   // MINIMALIS CARPORT
                'R' => 0,        // TALANG AIR
                'S' => 0,        // JENDELA
                'T' => 0,        // ELEKTRICAL
            ],

           // =============== TYPE 40 ===============
            '40' => [
                'A' => 1668000,   // PONDASI
                'B' => 668000,    // URUG
                'C' => 400000,    // COR LANTAI
                'D' => 0,         // PINTU
                'E' => 2780000,   // BATA
                'F' => 0,
                'G' => 2500000,   // PLASTER
                'H' => 1336000,   // ATAP
                'I' => 780000,    // DEK
                'J' => 504000,    // MINIMALIS
                'K' => 668000,         // CARPORT
                'L' => 1112000,   // KERAMIK
                'M' => 180000,    // WC
                'N' => 434000,     // ACI MINIMALIS
                'O' => 1390000,    // CAT
                'P' => 178000,    // PAGAR
                'Q' => 221000,    // MINIMALIS CARPORT
                'R' => 0,
                'S' => 0,
                'T' => 0,
            ],

            // =============== TYPE 45 ===============
            '45' => [
                'A' => 1876500,
                'B' => 751500,
                'C' => 450000,
                'D' => 0,
                'E' => 3127500,
                'F' => 0,
                'G' => 2812500,
                'H' => 1503000,
                'I' => 877500,
                'J' => 1260000,
                'K' => 828100,
                'L' => 1251000,
                'M' => 900000,
                'N' => 1085250,
                'O' => 1260000,
                'P' => 445250,
                'Q' => 552500,
                'R' => 0,
                'S' => 0,
                'T' => 0,
            ],

            // =============== TYPE 50 ===============
            // (Berdasarkan gambar laporan yang diberikan)
            '50' => [
                'A' => 2085000,   // PONDASI - Rp 3.336.000
                'B' => 835500,   // URUG - Rp 1.336.000
                'C' => 500000,    // COR LANTAI - Rp 800.000
                'D' => 0,         // PINTU - dikerjakan sendiri
                'E' => 3475000,   // BATA - Rp 5.560.000
                'F' => 0,         // COR TIANG DEPAN
                'G' => 3125000,   // PLASTER - Rp 5.000.000
                'H' => 1670000,   // ATAP - Rp 2.672.000
                'I' => 975000,   // DEK - Rp 1.560.000
                'J' => 630000,   // MINIMALIS - Rp 1.512.000
                'K' => 835000,   // CARPORT - Rp 1.336.000
                'L' => 1390000,   // KERAMIK - Rp 2.224.000
                'M' => 225000,    // WC - Rp 990.000
                'N' => 542500,   // ACI MINIMALIS - Rp 1.302.000
                'O' => 1737500,   // CAT - Rp 2.780.000
                'P' => 222500,    // PAGAR - Rp 534.000
                'Q' => 276250,    // MINIMALIS CARPORT - Rp 663.000
                'R' => 0,         // TALANG AIR
                'S' => 0,         // JENDELA
                'T' => 0,         // ELEKTRICAL
            ],

            // =============== TYPE 55 ===============
            '55' => [
                'A' => 2293500,   // PONDASI
                'B' => 918500,    // URUG
                'C' => 550000,    // COR LANTAI
                'D' => 0,   // PINTU
                'E' => 3822500,   // BATA
                'F' => 0,         // COR TIANG DEPAN
                'G' => 3437500,   // PLASTER
                'H' => 1837000,   // ATAP
                'I' => 1072500,    // DEK
                'J' => 693000,    // MINIMALIS
                'K' => 918500,    // CARPORT
                'L' => 1529000,   // KERAMIK
                'M' => 247500,    // WC
                'N' => 596750,   // ACI MINIMALIS
                'O' => 1911250,   // CAT    
                'P' => 244750,    // PAGAR
                'Q' => 303875,    // MINIMALIS CARPORT
                'R' => 0,         // TALANG AIR
                'S' => 0,         // JENDELA
                'T' => 0,         // ELEKTRICAL
            ],

            // =============== TYPE 60 ===============
            '60' => [
                'A' => 2502000,
                'B' => 1002000,
                'C' => 600000,
                'D' => 0,
                'E' => 4170000,
                'F' => 0,
                'G' => 3750000,
                'H' => 2004000,
                'I' => 1170000,
                'J' => 1260000,
                'K' => 828100,
                'L' => 1668000,
                'M' => 900000,
                'N' => 1085000,
                'O' => 2085000,
                'P' => 445000,
                'Q' => 552500,
                'R' => 0,
                'S' => 0,
                'T' => 0,
            ],

            // =============== TYPE 70 ===============
            '70' => [
                'A' => 2919000,
                'B' => 1169000,
                'C' => 700000,
                'D' => 0,
                'E' => 4865000,
                'F' => 0,
                'G' => 4375000,
                'H' => 2338000,
                'I' => 1365000,
                'J' => 882000,
                'K' => 1169000,
                'L' => 1946000,
                'M' => 315000,
                'N' => 759500,
                'O' => 2432500,
                'P' => 311500,
                'Q' => 386750,
                'R' => 0,
                'S' => 0,
                'T' => 0,
            ],

            // =============== TYPE 80 ===============
            '80' => [
                'A' => 3336000,
                'B' => 1336000,
                'C' => 800000,
                'D' => 0,
                'E' => 5560000,
                'F' => 0,
                'G' => 5000000,
                'H' => 2672000,
                'I' => 1560000,
                'J' => 1512000,
                'K' => 1336000,
                'L' => 2224000,
                'M' => 990000,
                'N' => 1302000,
                'O' => 2780000,
                'P' => 534000,
                'Q' => 663000,
                'R' => 0,
                'S' => 0,
                'T' => 0,
            ],

            // =============== TYPE 100 ===============
            '100' => [
                'A' => 4170000,
                'B' => 1670000,
                'C' => 1000000,
                'D' => 0,
                'E' => 6950000,
                'F' => 0,
                'G' => 6250000,
                'H' => 3340000,
                'I' => 1950000,
                'J' => 1260000,
                'K' => 1670000,
                'L' => 2780000,
                'M' => 900000,
                'N' => 1085000,
                'O' => 3475000,
                'P' => 445000,
                'Q' => 552500,
                'R' => 272000,
                'S' => 0,
                'T' => 0,
            ],

            // =============== TYPE 107 ===============
            '107' => [
                'A' => 4461900,
                'B' => 1786900,
                'C' => 1070000,
                'D' => 0,
                'E' => 7436500,
                'F' => 0,
                'G' => 6687500,
                'H' => 3573800,
                'I' => 2086500,
                'J' => 1348200,
                'K' => 1786900,
                'L' => 2974600,
                'M' => 981500,
                'N' => 1160950,
                'O' => 3718250,
                'P' => 476150,
                'Q' => 591175,
                'R' => 0,
                'S' => 0,
                'T' => 0,
            ],
        ];

        // Ambil semua categories
        $categories = RabCategory::all()->keyBy('kode');

        foreach ($boronganData as $typeName => $categoryBorongans) {
            
            $type = Type::where('nama', $typeName)->first();
            
            if (!$type) {
                echo "⚠ Type {$typeName} tidak ditemukan!\n";
                continue;
            }

            foreach ($categoryBorongans as $kodeKategori => $nilaiBorongan) {
                
                $category = $categories->get($kodeKategori);
                
                if (!$category) {
                    echo "⚠ Kategori {$kodeKategori} tidak ditemukan!\n";
                    continue;
                }

                // Note: Borongan ini adalah nilai default per type
                // Akan di-copy ke RabCategoryBorongan saat RAB dibuat untuk unit tertentu
                // Atau bisa digunakan sebagai referensi default

                echo "✔ Type {$typeName} - {$category->nama}: Rp " . number_format($nilaiBorongan, 0, ',', '.') . "\n";
            }
        }

        echo "\n✔ SELESAI — DATA BORONGAN BERHASIL DIKONFIGURASI\n";
        echo "Note: Nilai borongan ini akan digunakan sebagai default saat membuat RAB baru.\n";
    }

    /**
     * Get default borongan value for a specific type and category
     * Dapat dipanggil dari controller atau service
     */
    public static function getDefaultBorongan($typeName, $kodeKategori)
    {
        $boronganData = self::getBoronganData();
        
        return $boronganData[$typeName][$kodeKategori] ?? 0;
    }

    /**
     * Get all borongan data
     */
    public static function getBoronganData()
    {
        return [
            '36' => [
                'A' => 2500000, 'B' => 1000000, 'C' => 600000, 'D' => 0,
                'E' => 4000000, 'F' => 0, 'G' => 3500000, 'H' => 2000000,
                'I' => 1200000, 'J' => 1000000, 'K' => 1000000, 'L' => 1800000,
                'M' => 750000, 'N' => 1000000, 'O' => 2000000, 'P' => 400000,
                'Q' => 500000, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '40' => [
                'A' => 1668000, 'B' => 668000, 'C' => 400000, 'D' => 0,
                'E' => 2780000, 'F' => 0, 'G' => 2500000, 'H' => 1336000,
                'I' => 780000, 'J' => 504000, 'K' => 668000, 'L' => 1112000,
                'M' => 180000, 'N' => 434000, 'O' => 1390000, 'P' => 178000,
                'Q' => 221000, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '45' => [
                'A' => 1876500, 'B' => 751500, 'C' => 450000, 'D' => 0,
                'E' => 3127500, 'F' => 0, 'G' => 2812500, 'H' => 1503000,
                'I' => 877500, 'J' => 1260000, 'K' => 828100, 'L' => 1251000,
                'M' => 900000, 'N' => 1085250, 'O' => 1260000, 'P' => 445250,
                'Q' => 552500, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '50' => [
                'A' => 2085000, 'B' => 835500, 'C' => 500000, 'D' => 0,
                'E' => 3475000, 'F' => 0, 'G' => 3125000, 'H' => 1670000,
                'I' => 975000, 'J' => 630000, 'K' => 835000, 'L' => 1390000,
                'M' => 225000, 'N' => 542500, 'O' => 1737500, 'P' => 222500,
                'Q' => 276250, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '55' => [
                'A' => 2293500, 'B' => 918500, 'C' => 550000, 'D' => 0,
                'E' => 3822500, 'F' => 0, 'G' => 3437500, 'H' => 1837000,
                'I' => 1072500, 'J' => 693000, 'K' => 918500, 'L' => 1529000,
                'M' => 247500, 'N' => 596750, 'O' => 1911250, 'P' => 244750,
                'Q' => 303875, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '60' => [
                'A' => 2502000, 'B' => 1002000, 'C' => 600000, 'D' => 0,
                'E' => 4170000, 'F' => 0, 'G' => 3750000, 'H' => 2004000,
                'I' => 1170000, 'J' => 1260000, 'K' => 828100, 'L' => 1668000,
                'M' => 900000, 'N' => 1085000, 'O' => 2085000, 'P' => 445000,
                'Q' => 552500, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '70' => [
                'A' => 2919000, 'B' => 1169000, 'C' => 700000, 'D' => 0,
                'E' => 4865000, 'F' => 0, 'G' => 4375000, 'H' => 2338000,
                'I' => 1365000, 'J' => 882000, 'K' => 1169000, 'L' => 1946000,
                'M' => 315000, 'N' => 759500, 'O' => 2432500, 'P' => 311500,
                'Q' => 386750, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '80' => [
                'A' => 3336000, 'B' => 1336000, 'C' => 800000, 'D' => 0,
                'E' => 5560000, 'F' => 0, 'G' => 5000000, 'H' => 2672000,
                'I' => 1560000, 'J' => 1512000, 'K' => 1336000, 'L' => 2224000,
                'M' => 990000, 'N' => 1302000, 'O' => 2780000, 'P' => 534000,
                'Q' => 663000, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
            '100' => [
                'A' => 4170000, 'B' => 1670000, 'C' => 1000000, 'D' => 0,
                'E' => 6950000, 'F' => 0, 'G' => 6250000, 'H' => 3340000,
                'I' => 1950000, 'J' => 1260000, 'K' => 1670000, 'L' => 2780000,
                'M' => 900000, 'N' => 1085000, 'O' => 3475000, 'P' => 445000,
                'Q' => 552500, 'R' => 272000, 'S' => 0, 'T' => 0,
            ],
            '107' => [
                'A' => 4461900, 'B' => 1786900, 'C' => 1070000, 'D' => 0,
                'E' => 7436500, 'F' => 0, 'G' => 6687500, 'H' => 3573800,
                'I' => 2086500, 'J' => 1348200, 'K' => 1786900, 'L' => 2974600,
                'M' => 981500, 'N' => 1160950, 'O' => 3718250, 'P' => 476150,
                'Q' => 591175, 'R' => 0, 'S' => 0, 'T' => 0,
            ],
        ];
    }
}
